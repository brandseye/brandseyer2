<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The brandseyer2 Cookbook • brandseyer2</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The brandseyer2 Cookbook">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brandseyer2</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased package">0.0.1.9017</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/brandseyer2.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cookbook.html">The brandseyer2 Cookbook</a>
    </li>
    <li>
      <a href="../articles/filtering.html">Filtering</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brandseye/brandseyer2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The brandseyer2 Cookbook</h1>
                        <h4 class="author">Constance Neeser</h4>
            
            <h4 class="date">2018-08-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/brandseye/brandseyer2/blob/master/vignettes/cookbook.Rmd"><code>vignettes/cookbook.Rmd</code></a></small>
      <div class="hidden name"><code>cookbook.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This is a collection of short scripts (recipes) to do some common things using brandseyer2. You should, for the most part, be able to copy and paste them in to an R file, change a few variables (like the account code and filter), and then run them.</p>
</div>
<div id="recipes" class="section level1">
<h1 class="hasAnchor">
<a href="#recipes" class="anchor"></a>Recipes</h1>
<div id="finding-topics-for-mentions" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-topics-for-mentions" class="anchor"></a>Finding topics for mentions</h2>
<p>Sometimes you may want to get a clean data set of mentions, and the topics on them. This small script will write out a CSV giving, for each topic on a mention, a row with the mention ID, topic ID, and topic name. It reads all the mentions matching a filter, asking for only the mentions’ IDs and tags. Then, using <code><a href="../reference/topics.html">topics()</a></code>, it gets all the topic data for the mentions. Next, it uses <code><a href="http://www.rdocumentation.org/packages/dplyr/topics/select">dplyr::select()</a></code> to choose only some interesting columns to keep. Finaly, it saves the data, using <code><a href="http://www.rdocumentation.org/packages/readr/topics/write_delim">readr::write_csv()</a></code>.</p>
<div id="the-recipe" class="section level3">
<h3 class="hasAnchor">
<a href="#the-recipe" class="anchor"></a>The Recipe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brandseyer2)
<span class="kw">library</span>(dplyr, <span class="dt">warn.conflicts =</span> <span class="ot">FALSE</span>)            <span class="co"># For manipulating tables</span>
<span class="kw">library</span>(readr)                                    <span class="co"># For writing CSVs</span>

code &lt;-<span class="st"> "BEUB03AA"</span>
filter &lt;-<span class="st"> "published inthelast week and brand isorchildof 46334"</span>

mentions_with_topics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/account.html">account</a></span>(code) <span class="op">%&gt;%</span><span class="st">         </span><span class="co"># Get the account</span>
<span class="st">  </span><span class="kw"><a href="../reference/mentions.html">mentions</a></span>(filter, <span class="dt">select =</span> <span class="kw">c</span>(id, tags)) <span class="op">%&gt;%</span><span class="st">      </span><span class="co"># Ask for the mentions (but only their IDs and tags)</span>
<span class="st">  </span><span class="kw"><a href="../reference/topics.html">topics</a></span>() <span class="op">%&gt;%</span><span class="st">                                    </span><span class="co"># From the mentions, get specific topics</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/select">select</a></span>(id, topic.id, name)                      <span class="co"># Select only some interesting columns</span>


<span class="kw"><a href="http://www.rdocumentation.org/packages/readr/topics/write_delim">write_csv</a></span>(mentions_with_topics, <span class="st">"topics.csv"</span>)</code></pre></div>
</div>
<div id="outcomes" class="section level3">
<h3 class="hasAnchor">
<a href="#outcomes" class="anchor"></a>Outcomes</h3>
<p>You can modify what columns you’d like kept in your CSV file by modifying the <code>select</code> line. And this is what some of the data looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&gt; # A tibble: 2,475 x 3</span>
<span class="co">#&gt;    id          topic.id name                                              </span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;                                             </span>
<span class="co">#&gt;  1 46334-8933…    70331 Comparing (brands to brands) or comparing (brands…</span>
<span class="co">#&gt;  2 46334-8933…    69873 Ethics or reputation                              </span>
<span class="co">#&gt;  3 46334-8933…    71303 Transport experience                              </span>
<span class="co">#&gt;  4 46334-8933…    71359 Drivers                                           </span>
<span class="co">#&gt;  5 46334-8933…    69878 Accusations of unethical behavior                 </span>
<span class="co">#&gt;  6 46334-8933…    69873 Ethics or reputation                              </span>
<span class="co">#&gt;  7 46334-8933…    70331 Comparing (brands to brands) or comparing (brands…</span>
<span class="co">#&gt;  8 46334-8933…    69873 Ethics or reputation                              </span>
<span class="co">#&gt;  9 46334-8933…    70331 Comparing (brands to brands) or comparing (brands…</span>
<span class="co">#&gt; 10 46334-8933…    69873 Ethics or reputation                              </span>
<span class="co">#&gt; # ... with 2,465 more rows</span></code></pre></div>
</div>
</div>
<div id="average-number-of-topics-per-mention" class="section level2">
<h2 class="hasAnchor">
<a href="#average-number-of-topics-per-mention" class="anchor"></a>Average number of topics per mention</h2>
<p>This is an extension of the recipe for finding topics on a mention. It uses dplyr to calculate the average number of mentions on a topic.</p>
<div id="the-recipe-1" class="section level3">
<h3 class="hasAnchor">
<a href="#the-recipe-1" class="anchor"></a>The Recipe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brandseyer2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(readr)

code &lt;-<span class="st"> "BEUB03AA"</span>
filter &lt;-<span class="st"> "published inthelast week and brand isorchildof 46334"</span>

mentions_with_topics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/account.html">account</a></span>(code) <span class="op">%&gt;%</span><span class="st">         </span><span class="co"># Get the account</span>
<span class="st">  </span><span class="kw"><a href="../reference/mentions.html">mentions</a></span>(filter, <span class="dt">select =</span> <span class="kw">c</span>(id, tags)) <span class="op">%&gt;%</span><span class="st">      </span><span class="co"># Ask for the mentions (but only their IDs and tags)</span>
<span class="st">  </span><span class="kw"><a href="../reference/topics.html">topics</a></span>() <span class="op">%&gt;%</span><span class="st">                                    </span><span class="co"># From the mentions, get specific topics</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/select">select</a></span>(id, topic.id, name)

topics_per_mention &lt;-<span class="st"> </span>mentions_with_topics <span class="op">%&gt;%</span><span class="st">   </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/group_by">group_by</a></span>(id) <span class="op">%&gt;%</span><span class="st">                </span><span class="co"># For each mention</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/summarise">summarise</a></span>(<span class="dt">count =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/n">n</a></span>())          <span class="co"># Count the number of mentions</span>

average_topics &lt;-<span class="st"> </span><span class="kw">sum</span>(topics_per_mention<span class="op">$</span>count) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(topics_per_mention)
<span class="kw">message</span>(glue<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/glue/topics/glue">glue</a></span>(<span class="st">"The average number of topics per mention is {round(average_topics, 2)}"</span>))</code></pre></div>
</div>
<div id="the-outcome" class="section level3">
<h3 class="hasAnchor">
<a href="#the-outcome" class="anchor"></a>The outcome</h3>
<p>The recipe prints out the average</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#&gt; The average number of topics per mention is 2.84</span></code></pre></div>
</div>
</div>
<div id="find-the-parent-of-topics" class="section level2">
<h2 class="hasAnchor">
<a href="#find-the-parent-of-topics" class="anchor"></a>Find the parent of topics</h2>
<p>BrandsEye topics can belong to more than one topic tree, and so can have more than one parent. When wanting to find the parent of a topic, you need to choose a topic tree to do this from. The easiest way to find topic trees is to use the <code><a href="../reference/topic_trees.html">topic_trees()</a></code> function, like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brandseyer2)
<span class="kw">library</span>(dplyr)

<span class="kw"><a href="../reference/account.html">account</a></span>(<span class="st">"TEST01AA"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/topic_trees.html">topic_trees</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/select">select</a></span>(id, name)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;      id name          </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;         </span>
<span class="co">#&gt; 1  1001 Tree of Topics</span></code></pre></div>
<div id="the-recipe-2" class="section level3">
<h3 class="hasAnchor">
<a href="#the-recipe-2" class="anchor"></a>The Recipe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brandseyer2)
<span class="kw">library</span>(dplyr)

<span class="kw"><a href="../reference/account.html">account</a></span>(<span class="st">"TEST01AA"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/tags.html">tags</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/with_tag_parents.html">with_tag_parents</a></span>(<span class="dv">1001</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/filter">filter</a></span>(namespace <span class="op">==</span><span class="st"> 'topic'</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/arrange">arrange</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/dplyr/topics/desc">desc</a></span>(is_parent), name)</code></pre></div>
</div>
<div id="the-outcome-1" class="section level3">
<h3 class="hasAnchor">
<a href="#the-outcome-1" class="anchor"></a>The outcome</h3>
<p>This produces a nicely sorted table of topics and parents, all in relation to the given topic tree. Notice that the topic tree itself won’t be in this table, since it is in its own <em>topic_tree</em> namespace.</p>
<pre><code>#&gt; # A tibble: 3 x 3
#&gt;      id name          parent
#&gt;   &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
#&gt; 1    10 Parent topic    1001
#&gt; 2    11 Child topic 1     10
#&gt; 3    12 Child topic 2     10</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#recipes">Recipes</a><ul class="nav nav-pills nav-stacked">
<li><a href="#finding-topics-for-mentions">Finding topics for mentions</a></li>
      <li><a href="#average-number-of-topics-per-mention">Average number of topics per mention</a></li>
      <li><a href="#find-the-parent-of-topics">Find the parent of topics</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Constance Neeser.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
