<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The brandseyer2 Cookbook • brandseyer2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The brandseyer2 Cookbook">
<meta property="og:description" content="brandseyer2">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brandseyer2</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.1.9032</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/brandseyer2.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cookbook.html">The brandseyer2 Cookbook</a>
    </li>
    <li>
      <a href="../articles/filtering.html">Filtering</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/brandseye/brandseyer2/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The brandseyer2 Cookbook</h1>
                        <h4 class="author">Constance Neeser</h4>
            
            <h4 class="date">2020-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/brandseye/brandseyer2/blob/master/vignettes/cookbook.Rmd"><code>vignettes/cookbook.Rmd</code></a></small>
      <div class="hidden name"><code>cookbook.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This is a collection of short scripts (recipes) to do some common things using brandseyer2. You should, for the most part, be able to copy and paste them in to an R file, change a few variables (like the account code and filter), and then run them.</p>
</div>
<div id="recipes" class="section level1">
<h1 class="hasAnchor">
<a href="#recipes" class="anchor"></a>Recipes</h1>
<div id="finding-topics-for-mentions" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-topics-for-mentions" class="anchor"></a>Finding topics for mentions</h2>
<p>Sometimes you may want to get a clean data set of mentions, and the topics on them. This small script will write out a CSV giving, for each topic on a mention, a row with the mention ID, topic ID, and topic name. It reads all the mentions matching a filter, asking for only the mentions’ IDs and tags. Then, using <code><a href="../reference/topics.html">topics()</a></code>, it gets all the topic data for the mentions. Next, it uses <code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code> to choose only some interesting columns to keep. Finaly, it saves the data, using <code><a href="https://readr.tidyverse.org/reference/write_delim.html">readr::write_csv()</a></code>.</p>
<div id="the-recipe" class="section level3">
<h3 class="hasAnchor">
<a href="#the-recipe" class="anchor"></a>The Recipe</h3>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">brandseyer2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>, <span class="kw">warn.conflicts</span> <span class="kw">=</span> <span class="fl">FALSE</span>)            <span class="co"># For manipulating tables</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">readr</span>)                                    <span class="co"># For writing CSVs</span>

<span class="no">code</span> <span class="kw">&lt;-</span> <span class="st">"BEUB03AA"</span>
<span class="no">filter</span> <span class="kw">&lt;-</span> <span class="st">"published inthelast week and brand isorchildof 46334"</span>

<span class="no">mentions_with_topics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/account.html">account</a></span>(<span class="no">code</span>) <span class="kw">%&gt;%</span>         <span class="co"># Get the account</span>
  <span class="fu"><a href="../reference/mentions.html">mentions</a></span>(<span class="no">filter</span>, <span class="kw">select</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">id</span>, <span class="no">tags</span>)) <span class="kw">%&gt;%</span>      <span class="co"># Ask for the mentions (but only their IDs and tags)</span>
  <span class="fu"><a href="../reference/topics.html">topics</a></span>() <span class="kw">%&gt;%</span>                                    <span class="co"># From the mentions, get specific topics</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">id</span>, <span class="no">topic.id</span>, <span class="no">name</span>)                      <span class="co"># Select only some interesting columns</span>


<span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span>(<span class="no">mentions_with_topics</span>, <span class="st">"topics.csv"</span>)</pre></body></html></div>
</div>
<div id="outcomes" class="section level3">
<h3 class="hasAnchor">
<a href="#outcomes" class="anchor"></a>Outcomes</h3>
<p>You can modify what columns you’d like kept in your CSV file by modifying the <code>select</code> line. And this is what some of the data looks like:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">#&gt; # A tibble: 2,475 x 3
#&gt;    id          topic.id name                                              
#&gt;    &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;                                             
#&gt;  1 46334-8933…    70331 Comparing (brands to brands) or comparing (brands…
#&gt;  2 46334-8933…    69873 Ethics or reputation                              
#&gt;  3 46334-8933…    71303 Transport experience                              
#&gt;  4 46334-8933…    71359 Drivers                                           
#&gt;  5 46334-8933…    69878 Accusations of unethical behavior                 
#&gt;  6 46334-8933…    69873 Ethics or reputation                              
#&gt;  7 46334-8933…    70331 Comparing (brands to brands) or comparing (brands…
#&gt;  8 46334-8933…    69873 Ethics or reputation                              
#&gt;  9 46334-8933…    70331 Comparing (brands to brands) or comparing (brands…
#&gt; 10 46334-8933…    69873 Ethics or reputation                              
#&gt; # ... with 2,465 more rows</pre></body></html></div>
</div>
</div>
<div id="average-number-of-topics-per-mention" class="section level2">
<h2 class="hasAnchor">
<a href="#average-number-of-topics-per-mention" class="anchor"></a>Average number of topics per mention</h2>
<p>This is an extension of the recipe for finding topics on a mention. It uses dplyr to calculate the average number of mentions on a topic.</p>
<div id="the-recipe-1" class="section level3">
<h3 class="hasAnchor">
<a href="#the-recipe-1" class="anchor"></a>The Recipe</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">brandseyer2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">readr</span>)

<span class="no">code</span> <span class="kw">&lt;-</span> <span class="st">"BEUB03AA"</span>
<span class="no">filter</span> <span class="kw">&lt;-</span> <span class="st">"published inthelast week and brand isorchildof 46334"</span>

<span class="no">mentions_with_topics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/account.html">account</a></span>(<span class="no">code</span>) <span class="kw">%&gt;%</span>         <span class="co"># Get the account</span>
  <span class="fu"><a href="../reference/mentions.html">mentions</a></span>(<span class="no">filter</span>, <span class="kw">select</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">id</span>, <span class="no">tags</span>)) <span class="kw">%&gt;%</span>      <span class="co"># Ask for the mentions (but only their IDs and tags)</span>
  <span class="fu"><a href="../reference/topics.html">topics</a></span>() <span class="kw">%&gt;%</span>                                    <span class="co"># From the mentions, get specific topics</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">id</span>, <span class="no">topic.id</span>, <span class="no">name</span>)

<span class="no">topics_per_mention</span> <span class="kw">&lt;-</span> <span class="no">mentions_with_topics</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">id</span>) <span class="kw">%&gt;%</span>                <span class="co"># For each mention</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">count</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>())          <span class="co"># Count the number of mentions</span>

<span class="no">average_topics</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">topics_per_mention</span>$<span class="no">count</span>) / <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">topics_per_mention</span>)
<span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="kw pkg">glue</span><span class="kw ns">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span>(<span class="st">"The average number of topics per mention is {round(average_topics, 2)}"</span>))</pre></body></html></div>
</div>
<div id="the-outcome" class="section level3">
<h3 class="hasAnchor">
<a href="#the-outcome" class="anchor"></a>The outcome</h3>
<p>The recipe prints out the average</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">#&gt; The average number of topics per mention is 2.84</pre></body></html></div>
</div>
</div>
<div id="find-the-parent-of-topics" class="section level2">
<h2 class="hasAnchor">
<a href="#find-the-parent-of-topics" class="anchor"></a>Find the parent of topics</h2>
<p>BrandsEye topics can belong to more than one topic tree, and so can have more than one parent. When wanting to find the parent of a topic, you need to choose a topic tree to do this from. The easiest way to find topic trees is to use the <code><a href="../reference/topic_trees.html">topic_trees()</a></code> function, like so:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">brandseyer2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="fu"><a href="../reference/account.html">account</a></span>(<span class="st">"TEST01AA"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/topic_trees.html">topic_trees</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">id</span>, <span class="no">name</span>)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;      id name          </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;         </span>
<span class="co">#&gt; 1  1001 Tree of Topics</span></pre></body></html></div>
<div id="the-recipe-2" class="section level3">
<h3 class="hasAnchor">
<a href="#the-recipe-2" class="anchor"></a>The Recipe</h3>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">brandseyer2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="fu"><a href="../reference/account.html">account</a></span>(<span class="st">"TEST01AA"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/tags.html">tags</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/with_tag_parents.html">with_tag_parents</a></span>(<span class="fl">1001</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">namespace</span> <span class="kw">==</span> <span class="st">'topic'</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">is_parent</span>), <span class="no">name</span>)</pre></body></html></div>
</div>
<div id="the-outcome-1" class="section level3">
<h3 class="hasAnchor">
<a href="#the-outcome-1" class="anchor"></a>The outcome</h3>
<p>This produces a nicely sorted table of topics and parents, all in relation to the given topic tree. Notice that the topic tree itself won’t be in this table, since it is in its own <em>topic_tree</em> namespace.</p>
<pre><code>#&gt; Source: local data frame [3 x 3]
#&gt; Groups: &lt;by row&gt;
#&gt; 
#&gt; # A tibble: 3 x 3
#&gt;      id name          parent
#&gt;   &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
#&gt; 1    10 Parent topic    1001
#&gt; 2    11 Child topic 1     10
#&gt; 3    12 Child topic 2     10</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Constance Neeser, Lara Basson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
